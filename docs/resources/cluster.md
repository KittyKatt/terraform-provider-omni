---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "omni_cluster Resource - omni"
subcategory: ""
description: |-
  Omni cluster template definition.
---

# omni_cluster (Resource)

Omni cluster template definition.

## Example Usage

```terraform
data "omni_cluster_template" "my_cluster" {
  name = var.cluster_name
  kubernetes {
    version = var.kubernetes_version
  }
  talos {
    version = var.talos_version
  }
}

resource "omni_cluster_machine_set_template" "controlplane" {
  kind     = "controlplane"
  machines = var.control_plane.machines
}

resource "omni_cluster_machine_set_template" "worker" {
  name     = var.workers.name
  kind     = "worker"
  machines = var.workers.machines
}

resource "omni_cluster_machine_template" "controlplanes" {
  for_each = var.control_plane.machines
  name     = each.key
  role     = "controlplane"
}

resource "omni_cluster_machine_template" "workers" {
  for_each = var.workers.machines
  name     = each.key
  role     = "worker"
}

resource "omni_cluster" "my_cluster" {
  cluster_template       = data.omni_cluster_template.my_cluster.yaml
  control_plane_template = omni_cluster_machine_set_template.controlplane.yaml
  workers_template = [
    omni_cluster_machine_set_template.workers.yaml
  ]
  machines_template = values(
    merge(
      { for machine in omni_cluster_machine_template.controlplane : machine.name => machine.yaml },
      { for machine in omni_cluster_machine_template.workers : machine.name => machine.yaml }
    )
  )
  delete_machine_links = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_template` (String) YAML document describing cluster.
- `control_plane_template` (String) YAML document describing control plane machine set.
- `machines_template` (List of String) YAML document describing machines.
- `workers_template` (List of String) YAML document describing workers machine sets.

### Optional

- `delete_machine_links` (Boolean) Controls if machine links are deleted when cluster is deleted.

### Read-Only

- `created_at` (String)
- `id` (String) Name (ID) of cluster.
- `last_updated` (String)
- `yaml` (String) Full YAML document descripting cluster template.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import omni_cluster.my_cluster "name_of_cluster"
```
